---
layout: post
title: "My Second data analysis samples"
subtitle: "Some fancy chart will be here"
background: '/img/posts/Logo.jpeg'
---

# CCTV analysis_Case Study

## Analysis of CCTV cameras in Seoul
Data obtained from [https://data.seoul.go.kr/](https://data.seoul.go.kr/dataList/OA-2734/C/1/datasetView.do). Working with following data : 
- number of CCTV cameras in Seoul by district
- population of each district in Seoul.


The goal is to analyze any possible correlations between population and the number of CCTV cameras in Seoul. 

### 1. Import and clean the dataset
`CCTV_Seoul` contains numbers of CCTV cameras in each year from 2011 to 2018 by district in Seoul. 


```python
# import libraries
import pandas as pd

# set woring directory
wd = '/Users/summerh/OneDrive/DS_project/'
filename = '200505_01_cctv_seoul.xlsx'

CCTV_Seoul = pd.read_excel(wd+filename, sheet_name = 'Excel_Import_1')#, encoding = 'utf-8')

# Set the column names
CCTV_Seoul.columns = ['District', 'Total', '~2011'] + list(range(2012,2019))
CCTV_Seoul.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>District</th>
      <th>Total</th>
      <th>~2011</th>
      <th>2012</th>
      <th>2013</th>
      <th>2014</th>
      <th>2015</th>
      <th>2016</th>
      <th>2017</th>
      <th>2018</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>강 남 구</td>
      <td>5221</td>
      <td>1944.0</td>
      <td>195.0</td>
      <td>316.0</td>
      <td>430</td>
      <td>546</td>
      <td>765</td>
      <td>577</td>
      <td>448</td>
    </tr>
    <tr>
      <th>1</th>
      <td>강 동 구</td>
      <td>1879</td>
      <td>303.0</td>
      <td>387.0</td>
      <td>134.0</td>
      <td>59</td>
      <td>144</td>
      <td>194</td>
      <td>273</td>
      <td>385</td>
    </tr>
    <tr>
      <th>2</th>
      <td>강 북 구</td>
      <td>1265</td>
      <td>243.0</td>
      <td>88.0</td>
      <td>141.0</td>
      <td>74</td>
      <td>145</td>
      <td>254</td>
      <td>1</td>
      <td>319</td>
    </tr>
    <tr>
      <th>3</th>
      <td>강 서 구</td>
      <td>1617</td>
      <td>219.0</td>
      <td>155.0</td>
      <td>118.0</td>
      <td>230</td>
      <td>187</td>
      <td>190</td>
      <td>264</td>
      <td>254</td>
    </tr>
    <tr>
      <th>4</th>
      <td>관 악 구</td>
      <td>3985</td>
      <td>430.0</td>
      <td>56.0</td>
      <td>419.0</td>
      <td>487</td>
      <td>609</td>
      <td>619</td>
      <td>694</td>
      <td>671</td>
    </tr>
  </tbody>
</table>
</div>



Check for the NaN values in the dataset. Define a function which shows the row containing NaN values. 



```python
# Detect NaN and show the rows
def find_Nan(df):
    return df[df.isnull().any(axis=1)]
```


```python
find_Nan(CCTV_Seoul)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>District</th>
      <th>Total</th>
      <th>~2011</th>
      <th>2012</th>
      <th>2013</th>
      <th>2014</th>
      <th>2015</th>
      <th>2016</th>
      <th>2017</th>
      <th>2018</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>10</th>
      <td>동대문구</td>
      <td>2003</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1326</td>
      <td>111</td>
      <td>233</td>
      <td>136</td>
      <td>197</td>
    </tr>
    <tr>
      <th>24</th>
      <td>중 랑 구</td>
      <td>1068</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>770</td>
      <td>102</td>
      <td>121</td>
      <td>66</td>
      <td>9</td>
    </tr>
  </tbody>
</table>
</div>



It turned out that original dataframe contains two rows with NaN values. Data from 2011 to 2013 is missing. Create a new column which sums all the years from 2014 to 2018. Then drop the columns used for summation. 


```python
# Make a column list
column_list = list(CCTV_Seoul) # create list of column index
del column_list[0:2] # Drop 'District', 'Total' from the list
del column_list[-4:] # Drop year from 2015
# column_list.remove('District') also works but takes only one argument each time. 
print(column_list)

# Create new column and drop the rest using the column list
CCTV_Seoul['~2014'] = CCTV_Seoul[column_list].sum(axis=1) # create column : row sum of column list
CCTV_Seoul = CCTV_Seoul.drop(column_list, axis=1) # drop years in column list. drop은 새로 데이터프레임으로 지정해줘야만 저장되는듯
#열방향으로 드랍해서 axis =1임

# Change order of columns
col = list(CCTV_Seoul)
col = col[0:2]+ [col[-1]] + col[2:-1]
CCTV_Seoul = CCTV_Seoul[col]

CCTV_Seoul.head() # Done
```

    ['~2011', 2012, 2013, 2014]
    




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>District</th>
      <th>Total</th>
      <th>~2014</th>
      <th>2015</th>
      <th>2016</th>
      <th>2017</th>
      <th>2018</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>강 남 구</td>
      <td>5221</td>
      <td>2885.0</td>
      <td>546</td>
      <td>765</td>
      <td>577</td>
      <td>448</td>
    </tr>
    <tr>
      <th>1</th>
      <td>강 동 구</td>
      <td>1879</td>
      <td>883.0</td>
      <td>144</td>
      <td>194</td>
      <td>273</td>
      <td>385</td>
    </tr>
    <tr>
      <th>2</th>
      <td>강 북 구</td>
      <td>1265</td>
      <td>546.0</td>
      <td>145</td>
      <td>254</td>
      <td>1</td>
      <td>319</td>
    </tr>
    <tr>
      <th>3</th>
      <td>강 서 구</td>
      <td>1617</td>
      <td>722.0</td>
      <td>187</td>
      <td>190</td>
      <td>264</td>
      <td>254</td>
    </tr>
    <tr>
      <th>4</th>
      <td>관 악 구</td>
      <td>3985</td>
      <td>1392.0</td>
      <td>609</td>
      <td>619</td>
      <td>694</td>
      <td>671</td>
    </tr>
  </tbody>
</table>
</div>



`pop_Seoul` consists of population of Seoul by each district in 2018. The population is classified into two major categories according to nationality : Korean and foreigner. It also contains the number of elderly living in each district of Seoul. 


```python
filename = '200505_01_pop_seoul.txt'
pop_Seoul = pd.read_csv(wd+filename, sep='\t', lineterminator='\r', header =2, thousands=',') # import tab-delimited txt file
pop_Seoul = pop_Seoul.iloc[:,[1,3,6,9,13]] # Extract columns needed
pop_Seoul.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>자치구</th>
      <th>계</th>
      <th>계.1</th>
      <th>계.2</th>
      <th>65세이상고령자</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>합계</td>
      <td>10013781</td>
      <td>9733655</td>
      <td>280126</td>
      <td>1518239</td>
    </tr>
    <tr>
      <th>1</th>
      <td>종로구</td>
      <td>161984</td>
      <td>151217</td>
      <td>10767</td>
      <td>28073</td>
    </tr>
    <tr>
      <th>2</th>
      <td>중구</td>
      <td>136469</td>
      <td>126175</td>
      <td>10294</td>
      <td>23794</td>
    </tr>
    <tr>
      <th>3</th>
      <td>용산구</td>
      <td>246165</td>
      <td>229579</td>
      <td>16586</td>
      <td>39439</td>
    </tr>
    <tr>
      <th>4</th>
      <td>성동구</td>
      <td>307193</td>
      <td>299042</td>
      <td>8151</td>
      <td>44728</td>
    </tr>
  </tbody>
</table>
</div>




```python
pop_Seoul.iloc[0,0] = 'Total' # Select specific cell using iloc
#Rename the columns index
pop_Seoul.rename(columns = {pop_Seoul.columns[0]:'District',
                            pop_Seoul.columns[1]: 'Population',
                            pop_Seoul.columns[2]:'Korean',
                            pop_Seoul.columns[3]:'Foreigner',
                            pop_Seoul.columns[4]:'Elderly'}, inplace = True)
pop_Seoul.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>District</th>
      <th>Population</th>
      <th>Korean</th>
      <th>Foreigner</th>
      <th>Elderly</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Total</td>
      <td>10013781</td>
      <td>9733655</td>
      <td>280126</td>
      <td>1518239</td>
    </tr>
    <tr>
      <th>1</th>
      <td>종로구</td>
      <td>161984</td>
      <td>151217</td>
      <td>10767</td>
      <td>28073</td>
    </tr>
    <tr>
      <th>2</th>
      <td>중구</td>
      <td>136469</td>
      <td>126175</td>
      <td>10294</td>
      <td>23794</td>
    </tr>
    <tr>
      <th>3</th>
      <td>용산구</td>
      <td>246165</td>
      <td>229579</td>
      <td>16586</td>
      <td>39439</td>
    </tr>
    <tr>
      <th>4</th>
      <td>성동구</td>
      <td>307193</td>
      <td>299042</td>
      <td>8151</td>
      <td>44728</td>
    </tr>
  </tbody>
</table>
</div>




```python
find_Nan(pop_Seoul)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>District</th>
      <th>Population</th>
      <th>Korean</th>
      <th>Foreigner</th>
      <th>Elderly</th>
    </tr>
  </thead>
  <tbody>
  </tbody>
</table>
</div>



`pop_Seoul` did not contain any NaN value. 

### 2. Inspect each dataframes and merge them. 
To see the broad scope, sort data by total number of CCTV cameras in each district. 


```python
#적절한 그래프를 넣으면 직관적이고 좋을듯  https://www.python-graph-gallery.com/
```


```python
CCTV_Seoul.sort_values(by='Total', ascending = False).head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>District</th>
      <th>Total</th>
      <th>~2014</th>
      <th>2015</th>
      <th>2016</th>
      <th>2017</th>
      <th>2018</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>강 남 구</td>
      <td>5221</td>
      <td>2885.0</td>
      <td>546</td>
      <td>765</td>
      <td>577</td>
      <td>448</td>
    </tr>
    <tr>
      <th>4</th>
      <td>관 악 구</td>
      <td>3985</td>
      <td>1392.0</td>
      <td>609</td>
      <td>619</td>
      <td>694</td>
      <td>671</td>
    </tr>
    <tr>
      <th>6</th>
      <td>구 로 구</td>
      <td>3227</td>
      <td>1607.0</td>
      <td>268</td>
      <td>326</td>
      <td>540</td>
      <td>486</td>
    </tr>
    <tr>
      <th>16</th>
      <td>성 북 구</td>
      <td>3003</td>
      <td>1408.0</td>
      <td>279</td>
      <td>388</td>
      <td>285</td>
      <td>643</td>
    </tr>
    <tr>
      <th>21</th>
      <td>은 평 구</td>
      <td>2962</td>
      <td>1890.0</td>
      <td>180</td>
      <td>296</td>
      <td>229</td>
      <td>367</td>
    </tr>
  </tbody>
</table>
</div>




```python
CCTV_Seoul.sort_values(by='Total', ascending = False).tail() 
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>District</th>
      <th>Total</th>
      <th>~2014</th>
      <th>2015</th>
      <th>2016</th>
      <th>2017</th>
      <th>2018</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>23</th>
      <td>중     구</td>
      <td>1544</td>
      <td>384.0</td>
      <td>245</td>
      <td>270</td>
      <td>317</td>
      <td>328</td>
    </tr>
    <tr>
      <th>22</th>
      <td>종 로 구</td>
      <td>1471</td>
      <td>746.0</td>
      <td>195</td>
      <td>148</td>
      <td>281</td>
      <td>101</td>
    </tr>
    <tr>
      <th>2</th>
      <td>강 북 구</td>
      <td>1265</td>
      <td>546.0</td>
      <td>145</td>
      <td>254</td>
      <td>1</td>
      <td>319</td>
    </tr>
    <tr>
      <th>24</th>
      <td>중 랑 구</td>
      <td>1068</td>
      <td>770.0</td>
      <td>102</td>
      <td>121</td>
      <td>66</td>
      <td>9</td>
    </tr>
    <tr>
      <th>9</th>
      <td>도 봉 구</td>
      <td>858</td>
      <td>456.0</td>
      <td>59</td>
      <td>155</td>
      <td>117</td>
      <td>71</td>
    </tr>
  </tbody>
</table>
</div>



Each number in the column indicates the increased number of CCTV cameras in each year. 강남구 records the higest number of CCTV in Seoul. Whereas 도봉구 records the lowest number of CCTV cameras. 강남구 has installed more than six times of cameras than 도봉구 did. 

Create a new column by calculating the percentage increase since 2015.


```python
# Calculate percentage increase since 2015
inc_range = list(range(2015,2019)) # list to sum year 2015 to 2018
CCTV_Seoul['Per_inc'] = CCTV_Seoul[inc_range].sum(axis=1)/CCTV_Seoul['~2014']*100
CCTV_Seoul.sort_values(by='Per_inc', ascending = False).head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>District</th>
      <th>Total</th>
      <th>~2014</th>
      <th>2015</th>
      <th>2016</th>
      <th>2017</th>
      <th>2018</th>
      <th>Per_inc</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>7</th>
      <td>금 천 구</td>
      <td>1634</td>
      <td>387.0</td>
      <td>382</td>
      <td>136</td>
      <td>199</td>
      <td>530</td>
      <td>322.222222</td>
    </tr>
    <tr>
      <th>23</th>
      <td>중     구</td>
      <td>1544</td>
      <td>384.0</td>
      <td>245</td>
      <td>270</td>
      <td>317</td>
      <td>328</td>
      <td>302.083333</td>
    </tr>
    <tr>
      <th>19</th>
      <td>영등포구</td>
      <td>2495</td>
      <td>676.0</td>
      <td>366</td>
      <td>289</td>
      <td>371</td>
      <td>793</td>
      <td>269.082840</td>
    </tr>
    <tr>
      <th>4</th>
      <td>관 악 구</td>
      <td>3985</td>
      <td>1392.0</td>
      <td>609</td>
      <td>619</td>
      <td>694</td>
      <td>671</td>
      <td>186.278736</td>
    </tr>
    <tr>
      <th>15</th>
      <td>성 동 구</td>
      <td>2679</td>
      <td>993.0</td>
      <td>258</td>
      <td>201</td>
      <td>933</td>
      <td>294</td>
      <td>169.788520</td>
    </tr>
  </tbody>
</table>
</div>



금천구 and 중구 have increased the number of CCTV cameras about three times more since 2015.

Does it mean that 강남구 or 금천구 has highest population in Seoul? Sort `pop_Seoul` dataframe by total population. Drop the first 'Total' row as it's not needed in the further analysis.


```python
pop_Seoul.drop([0], inplace = True)
pop_Seoul.sort_values(by='Population', ascending= False).head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>District</th>
      <th>Population</th>
      <th>Korean</th>
      <th>Foreigner</th>
      <th>Elderly</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>24</th>
      <td>송파구</td>
      <td>680883</td>
      <td>674095</td>
      <td>6788</td>
      <td>89539</td>
    </tr>
    <tr>
      <th>16</th>
      <td>강서구</td>
      <td>595703</td>
      <td>589302</td>
      <td>6401</td>
      <td>85992</td>
    </tr>
    <tr>
      <th>23</th>
      <td>강남구</td>
      <td>549898</td>
      <td>544804</td>
      <td>5094</td>
      <td>72602</td>
    </tr>
    <tr>
      <th>11</th>
      <td>노원구</td>
      <td>535495</td>
      <td>531037</td>
      <td>4458</td>
      <td>82682</td>
    </tr>
    <tr>
      <th>21</th>
      <td>관악구</td>
      <td>516662</td>
      <td>499374</td>
      <td>17288</td>
      <td>76664</td>
    </tr>
  </tbody>
</table>
</div>



None of those high number of CCTV districts were included in the top 5 population in Seoul district. Calculate the ratio of foreigners and elderies. 


```python
pop_Seoul['r_foreigner'] = pop_Seoul['Foreigner']/pop_Seoul['Population']*100
pop_Seoul['r_elderly'] = pop_Seoul['Elderly']/pop_Seoul['Population']*100
pop_Seoul.sort_values(by='r_foreigner', ascending= False).head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>District</th>
      <th>Population</th>
      <th>Korean</th>
      <th>Foreigner</th>
      <th>Elderly</th>
      <th>r_foreigner</th>
      <th>r_elderly</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>19</th>
      <td>영등포구</td>
      <td>404766</td>
      <td>371903</td>
      <td>32863</td>
      <td>59373</td>
      <td>8.119012</td>
      <td>14.668475</td>
    </tr>
    <tr>
      <th>2</th>
      <td>중구</td>
      <td>136469</td>
      <td>126175</td>
      <td>10294</td>
      <td>23794</td>
      <td>7.543105</td>
      <td>17.435462</td>
    </tr>
    <tr>
      <th>18</th>
      <td>금천구</td>
      <td>251370</td>
      <td>232583</td>
      <td>18787</td>
      <td>38508</td>
      <td>7.473843</td>
      <td>15.319251</td>
    </tr>
    <tr>
      <th>17</th>
      <td>구로구</td>
      <td>438308</td>
      <td>405837</td>
      <td>32471</td>
      <td>67432</td>
      <td>7.408261</td>
      <td>15.384615</td>
    </tr>
    <tr>
      <th>3</th>
      <td>용산구</td>
      <td>246165</td>
      <td>229579</td>
      <td>16586</td>
      <td>39439</td>
      <td>6.737757</td>
      <td>16.021368</td>
    </tr>
  </tbody>
</table>
</div>



Foreigners in 영등포구 account for about 8% of the population in the district, which is the highest ratio in Seoul. 중구 followed 영등포구 with 7.5%. 


```python
pop_Seoul.sort_values(by='Foreigner', ascending = False).head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>District</th>
      <th>Population</th>
      <th>Korean</th>
      <th>Foreigner</th>
      <th>Elderly</th>
      <th>r_foreigner</th>
      <th>r_elderly</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>19</th>
      <td>영등포구</td>
      <td>404766</td>
      <td>371903</td>
      <td>32863</td>
      <td>59373</td>
      <td>8.119012</td>
      <td>14.668475</td>
    </tr>
    <tr>
      <th>17</th>
      <td>구로구</td>
      <td>438308</td>
      <td>405837</td>
      <td>32471</td>
      <td>67432</td>
      <td>7.408261</td>
      <td>15.384615</td>
    </tr>
    <tr>
      <th>18</th>
      <td>금천구</td>
      <td>251370</td>
      <td>232583</td>
      <td>18787</td>
      <td>38508</td>
      <td>7.473843</td>
      <td>15.319251</td>
    </tr>
    <tr>
      <th>21</th>
      <td>관악구</td>
      <td>516662</td>
      <td>499374</td>
      <td>17288</td>
      <td>76664</td>
      <td>3.346095</td>
      <td>14.838328</td>
    </tr>
    <tr>
      <th>6</th>
      <td>동대문구</td>
      <td>362793</td>
      <td>346156</td>
      <td>16637</td>
      <td>60367</td>
      <td>4.585811</td>
      <td>16.639516</td>
    </tr>
  </tbody>
</table>
</div>



As expected, 영등포구 has highest number of foreigners living in Seoul. 


```python
pop_Seoul.sort_values(by='r_elderly', ascending = False).head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>District</th>
      <th>Population</th>
      <th>Korean</th>
      <th>Foreigner</th>
      <th>Elderly</th>
      <th>r_foreigner</th>
      <th>r_elderly</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>9</th>
      <td>강북구</td>
      <td>316750</td>
      <td>312985</td>
      <td>3765</td>
      <td>61660</td>
      <td>1.188635</td>
      <td>19.466456</td>
    </tr>
    <tr>
      <th>10</th>
      <td>도봉구</td>
      <td>333495</td>
      <td>331238</td>
      <td>2257</td>
      <td>60023</td>
      <td>0.676772</td>
      <td>17.998171</td>
    </tr>
    <tr>
      <th>2</th>
      <td>중구</td>
      <td>136469</td>
      <td>126175</td>
      <td>10294</td>
      <td>23794</td>
      <td>7.543105</td>
      <td>17.435462</td>
    </tr>
    <tr>
      <th>1</th>
      <td>종로구</td>
      <td>161984</td>
      <td>151217</td>
      <td>10767</td>
      <td>28073</td>
      <td>6.646953</td>
      <td>17.330724</td>
    </tr>
    <tr>
      <th>12</th>
      <td>은평구</td>
      <td>482509</td>
      <td>478019</td>
      <td>4490</td>
      <td>82245</td>
      <td>0.930553</td>
      <td>17.045278</td>
    </tr>
  </tbody>
</table>
</div>




```python
pop_Seoul.sort_values(by='r_elderly', ascending = True).head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>District</th>
      <th>Population</th>
      <th>Korean</th>
      <th>Foreigner</th>
      <th>Elderly</th>
      <th>r_foreigner</th>
      <th>r_elderly</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>24</th>
      <td>송파구</td>
      <td>680883</td>
      <td>674095</td>
      <td>6788</td>
      <td>89539</td>
      <td>0.996941</td>
      <td>13.150424</td>
    </tr>
    <tr>
      <th>23</th>
      <td>강남구</td>
      <td>549898</td>
      <td>544804</td>
      <td>5094</td>
      <td>72602</td>
      <td>0.926354</td>
      <td>13.202812</td>
    </tr>
    <tr>
      <th>5</th>
      <td>광진구</td>
      <td>365990</td>
      <td>350417</td>
      <td>15573</td>
      <td>48989</td>
      <td>4.255034</td>
      <td>13.385338</td>
    </tr>
    <tr>
      <th>22</th>
      <td>서초구</td>
      <td>434801</td>
      <td>430568</td>
      <td>4233</td>
      <td>58332</td>
      <td>0.973549</td>
      <td>13.415793</td>
    </tr>
    <tr>
      <th>15</th>
      <td>양천구</td>
      <td>460532</td>
      <td>456339</td>
      <td>4193</td>
      <td>62761</td>
      <td>0.910469</td>
      <td>13.627935</td>
    </tr>
  </tbody>
</table>
</div>



Elderly people accounts for 19% of the population in 강북구. However 송파구 only had 13% of elederly in the district. 


```python
pop_Seoul.sort_values(by='Elderly', ascending = False).head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>District</th>
      <th>Population</th>
      <th>Korean</th>
      <th>Foreigner</th>
      <th>Elderly</th>
      <th>r_foreigner</th>
      <th>r_elderly</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>24</th>
      <td>송파구</td>
      <td>680883</td>
      <td>674095</td>
      <td>6788</td>
      <td>89539</td>
      <td>0.996941</td>
      <td>13.150424</td>
    </tr>
    <tr>
      <th>16</th>
      <td>강서구</td>
      <td>595703</td>
      <td>589302</td>
      <td>6401</td>
      <td>85992</td>
      <td>1.074529</td>
      <td>14.435381</td>
    </tr>
    <tr>
      <th>11</th>
      <td>노원구</td>
      <td>535495</td>
      <td>531037</td>
      <td>4458</td>
      <td>82682</td>
      <td>0.832501</td>
      <td>15.440294</td>
    </tr>
    <tr>
      <th>12</th>
      <td>은평구</td>
      <td>482509</td>
      <td>478019</td>
      <td>4490</td>
      <td>82245</td>
      <td>0.930553</td>
      <td>17.045278</td>
    </tr>
    <tr>
      <th>21</th>
      <td>관악구</td>
      <td>516662</td>
      <td>499374</td>
      <td>17288</td>
      <td>76664</td>
      <td>3.346095</td>
      <td>14.838328</td>
    </tr>
  </tbody>
</table>
</div>



District names in `CCTV_Seoul` include blank spaces. After stripping the white spaces, merge two dataframes using 'District' as a key. 


```python
# strip white spaces
CCTV_Seoul['District'] = CCTV_Seoul['District'].str.replace(" ","")
CCTV_Seoul['District'].head() # Done
```




    0    강남구
    1    강동구
    2    강북구
    3    강서구
    4    관악구
    Name: District, dtype: object




```python
# Merge two dataframes
Seoul = pd.merge(CCTV_Seoul, pop_Seoul, on = 'District')
Seoul.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>District</th>
      <th>Total</th>
      <th>~2014</th>
      <th>2015</th>
      <th>2016</th>
      <th>2017</th>
      <th>2018</th>
      <th>Per_inc</th>
      <th>Population</th>
      <th>Korean</th>
      <th>Foreigner</th>
      <th>Elderly</th>
      <th>r_foreigner</th>
      <th>r_elderly</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>강남구</td>
      <td>5221</td>
      <td>2885.0</td>
      <td>546</td>
      <td>765</td>
      <td>577</td>
      <td>448</td>
      <td>80.970537</td>
      <td>549898</td>
      <td>544804</td>
      <td>5094</td>
      <td>72602</td>
      <td>0.926354</td>
      <td>13.202812</td>
    </tr>
    <tr>
      <th>1</th>
      <td>강동구</td>
      <td>1879</td>
      <td>883.0</td>
      <td>144</td>
      <td>194</td>
      <td>273</td>
      <td>385</td>
      <td>112.797282</td>
      <td>457042</td>
      <td>452646</td>
      <td>4396</td>
      <td>66401</td>
      <td>0.961837</td>
      <td>14.528424</td>
    </tr>
    <tr>
      <th>2</th>
      <td>강북구</td>
      <td>1265</td>
      <td>546.0</td>
      <td>145</td>
      <td>254</td>
      <td>1</td>
      <td>319</td>
      <td>131.684982</td>
      <td>316750</td>
      <td>312985</td>
      <td>3765</td>
      <td>61660</td>
      <td>1.188635</td>
      <td>19.466456</td>
    </tr>
    <tr>
      <th>3</th>
      <td>강서구</td>
      <td>1617</td>
      <td>722.0</td>
      <td>187</td>
      <td>190</td>
      <td>264</td>
      <td>254</td>
      <td>123.961219</td>
      <td>595703</td>
      <td>589302</td>
      <td>6401</td>
      <td>85992</td>
      <td>1.074529</td>
      <td>14.435381</td>
    </tr>
    <tr>
      <th>4</th>
      <td>관악구</td>
      <td>3985</td>
      <td>1392.0</td>
      <td>609</td>
      <td>619</td>
      <td>694</td>
      <td>671</td>
      <td>186.278736</td>
      <td>516662</td>
      <td>499374</td>
      <td>17288</td>
      <td>76664</td>
      <td>3.346095</td>
      <td>14.838328</td>
    </tr>
  </tbody>
</table>
</div>




```python
# Compare by counting unique values
CCTV_Seoul['District'].nunique()== pop_Seoul['District'].nunique()==Seoul['District'].nunique() # Great
```




    True



Successfully merged. In order to avoid any confusion, 
change the column name from 'Total' to 'CCTV'. Drop the unnecessary columns ~2014 to 2018. 


```python
# Change the column name
Seoul.rename(columns={'Total':'CCTV'}, inplace=True)
Seoul.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>District</th>
      <th>CCTV</th>
      <th>~2014</th>
      <th>2015</th>
      <th>2016</th>
      <th>2017</th>
      <th>2018</th>
      <th>Per_inc</th>
      <th>Population</th>
      <th>Korean</th>
      <th>Foreigner</th>
      <th>Elderly</th>
      <th>r_foreigner</th>
      <th>r_elderly</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>강남구</td>
      <td>5221</td>
      <td>2885.0</td>
      <td>546</td>
      <td>765</td>
      <td>577</td>
      <td>448</td>
      <td>80.970537</td>
      <td>549898</td>
      <td>544804</td>
      <td>5094</td>
      <td>72602</td>
      <td>0.926354</td>
      <td>13.202812</td>
    </tr>
    <tr>
      <th>1</th>
      <td>강동구</td>
      <td>1879</td>
      <td>883.0</td>
      <td>144</td>
      <td>194</td>
      <td>273</td>
      <td>385</td>
      <td>112.797282</td>
      <td>457042</td>
      <td>452646</td>
      <td>4396</td>
      <td>66401</td>
      <td>0.961837</td>
      <td>14.528424</td>
    </tr>
    <tr>
      <th>2</th>
      <td>강북구</td>
      <td>1265</td>
      <td>546.0</td>
      <td>145</td>
      <td>254</td>
      <td>1</td>
      <td>319</td>
      <td>131.684982</td>
      <td>316750</td>
      <td>312985</td>
      <td>3765</td>
      <td>61660</td>
      <td>1.188635</td>
      <td>19.466456</td>
    </tr>
    <tr>
      <th>3</th>
      <td>강서구</td>
      <td>1617</td>
      <td>722.0</td>
      <td>187</td>
      <td>190</td>
      <td>264</td>
      <td>254</td>
      <td>123.961219</td>
      <td>595703</td>
      <td>589302</td>
      <td>6401</td>
      <td>85992</td>
      <td>1.074529</td>
      <td>14.435381</td>
    </tr>
    <tr>
      <th>4</th>
      <td>관악구</td>
      <td>3985</td>
      <td>1392.0</td>
      <td>609</td>
      <td>619</td>
      <td>694</td>
      <td>671</td>
      <td>186.278736</td>
      <td>516662</td>
      <td>499374</td>
      <td>17288</td>
      <td>76664</td>
      <td>3.346095</td>
      <td>14.838328</td>
    </tr>
  </tbody>
</table>
</div>




```python
Seoul.filter(regex='20').columns # filter the column name which included '20'
```




    Index(['~2014', 2015, 2016, 2017, 2018], dtype='object')




```python
# Drop the column with matching filters
Seoul.drop(Seoul.filter(regex='20').columns, axis =1 , inplace = True)
```


```python
Seoul.head() 
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>District</th>
      <th>CCTV</th>
      <th>Per_inc</th>
      <th>Population</th>
      <th>Korean</th>
      <th>Foreigner</th>
      <th>Elderly</th>
      <th>r_foreigner</th>
      <th>r_elderly</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>강남구</td>
      <td>5221</td>
      <td>80.970537</td>
      <td>549898</td>
      <td>544804</td>
      <td>5094</td>
      <td>72602</td>
      <td>0.926354</td>
      <td>13.202812</td>
    </tr>
    <tr>
      <th>1</th>
      <td>강동구</td>
      <td>1879</td>
      <td>112.797282</td>
      <td>457042</td>
      <td>452646</td>
      <td>4396</td>
      <td>66401</td>
      <td>0.961837</td>
      <td>14.528424</td>
    </tr>
    <tr>
      <th>2</th>
      <td>강북구</td>
      <td>1265</td>
      <td>131.684982</td>
      <td>316750</td>
      <td>312985</td>
      <td>3765</td>
      <td>61660</td>
      <td>1.188635</td>
      <td>19.466456</td>
    </tr>
    <tr>
      <th>3</th>
      <td>강서구</td>
      <td>1617</td>
      <td>123.961219</td>
      <td>595703</td>
      <td>589302</td>
      <td>6401</td>
      <td>85992</td>
      <td>1.074529</td>
      <td>14.435381</td>
    </tr>
    <tr>
      <th>4</th>
      <td>관악구</td>
      <td>3985</td>
      <td>186.278736</td>
      <td>516662</td>
      <td>499374</td>
      <td>17288</td>
      <td>76664</td>
      <td>3.346095</td>
      <td>14.838328</td>
    </tr>
  </tbody>
</table>
</div>




```python
# Set the row index
Seoul.set_index('District', inplace = True)
Seoul.rename(columns={'Per_inc':'CCTV_inc'}, inplace = True)
Seoul.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>CCTV</th>
      <th>CCTV_inc</th>
      <th>Population</th>
      <th>Korean</th>
      <th>Foreigner</th>
      <th>Elderly</th>
      <th>r_foreigner</th>
      <th>r_elderly</th>
    </tr>
    <tr>
      <th>District</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>강남구</th>
      <td>5221</td>
      <td>80.970537</td>
      <td>549898</td>
      <td>544804</td>
      <td>5094</td>
      <td>72602</td>
      <td>0.926354</td>
      <td>13.202812</td>
    </tr>
    <tr>
      <th>강동구</th>
      <td>1879</td>
      <td>112.797282</td>
      <td>457042</td>
      <td>452646</td>
      <td>4396</td>
      <td>66401</td>
      <td>0.961837</td>
      <td>14.528424</td>
    </tr>
    <tr>
      <th>강북구</th>
      <td>1265</td>
      <td>131.684982</td>
      <td>316750</td>
      <td>312985</td>
      <td>3765</td>
      <td>61660</td>
      <td>1.188635</td>
      <td>19.466456</td>
    </tr>
    <tr>
      <th>강서구</th>
      <td>1617</td>
      <td>123.961219</td>
      <td>595703</td>
      <td>589302</td>
      <td>6401</td>
      <td>85992</td>
      <td>1.074529</td>
      <td>14.435381</td>
    </tr>
    <tr>
      <th>관악구</th>
      <td>3985</td>
      <td>186.278736</td>
      <td>516662</td>
      <td>499374</td>
      <td>17288</td>
      <td>76664</td>
      <td>3.346095</td>
      <td>14.838328</td>
    </tr>
  </tbody>
</table>
</div>



### 3. Data analysis


```python
import numpy as np
import matplotlib.pyplot as plt
plt.rc('font', family='AppleGothic') # set the Korean font
%matplotlib inline  
#graph appears in the output part
```

Check for the correlation between the number of CCTV cameras and populiation. 


```python
np.corrcoef(Seoul['CCTV'], Seoul['r_foreigner']) # Almost no correlation
```




    array([[ 1.        , -0.06215538],
           [-0.06215538,  1.        ]])




```python
np.corrcoef(Seoul['CCTV'], Seoul['r_elderly']) 
# Shows negative correlation between ratio of elderly and the number of CCTV Cameras
```




    array([[ 1.        , -0.44225083],
           [-0.44225083,  1.        ]])




```python
np.corrcoef(Seoul['CCTV'], Seoul['Population']) # Shows weak positive correlation. 
```




    array([[1.        , 0.38064812],
           [0.38064812, 1.        ]])



Compare and visualize the districts with higher number of CCTV cameras and the districts with dense population.


```python
Seoul['CCTV'].sort_values().plot(kind= 'barh', grid = True, figsize=(10,10), color = 'gray')
plt.show()
```


    
![png](\img\posts\secondpost\output_47_0.png)
    



```python
Seoul['r_CCTV'] = Seoul['CCTV']/Seoul['Population']*100
Seoul['r_CCTV'].sort_values().plot(kind='barh', figsize = (10,10), grid = True, color='gray')
#Seoul['r_CCTV'].set_color('r') #Want to change the color of one bar
plt.show()
```


    
![png](\img\posts\secondpost\output_48_0.png)
    



```python
fp = np.polyfit(Seoul['Population'], Seoul['CCTV'], 1) # 1차함수 numbers
f1 = np.poly1d(fp) # y-axis, first order function
fx = np.linspace(100000,700000,100) # x-axis
Seoul['resid'] = np.abs(Seoul['CCTV']- f1(Seoul['Population'])) # calculate residual
Seoul_srt = Seoul.sort_values(by='resid', ascending = False)
Seoul_srt.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>CCTV</th>
      <th>CCTV_inc</th>
      <th>Population</th>
      <th>Korean</th>
      <th>Foreigner</th>
      <th>Elderly</th>
      <th>r_foreigner</th>
      <th>r_elderly</th>
      <th>r_CCTV</th>
      <th>resid</th>
    </tr>
    <tr>
      <th>District</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>강남구</th>
      <td>5221</td>
      <td>80.970537</td>
      <td>549898</td>
      <td>544804</td>
      <td>5094</td>
      <td>72602</td>
      <td>0.926354</td>
      <td>13.202812</td>
      <td>0.949449</td>
      <td>2570.380612</td>
    </tr>
    <tr>
      <th>송파구</th>
      <td>1586</td>
      <td>96.287129</td>
      <td>680883</td>
      <td>674095</td>
      <td>6788</td>
      <td>89539</td>
      <td>0.996941</td>
      <td>13.150424</td>
      <td>0.232933</td>
      <td>1442.540920</td>
    </tr>
    <tr>
      <th>관악구</th>
      <td>3985</td>
      <td>186.278736</td>
      <td>516662</td>
      <td>499374</td>
      <td>17288</td>
      <td>76664</td>
      <td>3.346095</td>
      <td>14.838328</td>
      <td>0.771297</td>
      <td>1430.274035</td>
    </tr>
    <tr>
      <th>도봉구</th>
      <td>858</td>
      <td>88.157895</td>
      <td>333495</td>
      <td>331238</td>
      <td>2257</td>
      <td>60023</td>
      <td>0.676772</td>
      <td>17.998171</td>
      <td>0.257275</td>
      <td>1168.247488</td>
    </tr>
    <tr>
      <th>강서구</th>
      <td>1617</td>
      <td>123.961219</td>
      <td>595703</td>
      <td>589302</td>
      <td>6401</td>
      <td>85992</td>
      <td>1.074529</td>
      <td>14.435381</td>
      <td>0.271444</td>
      <td>1165.777237</td>
    </tr>
  </tbody>
</table>
</div>




```python
plt.figure(figsize = (10,10))
plt.scatter(Seoul['Population'], Seoul['CCTV'], s = 50, c = Seoul['resid']) # s is marker size
plt.plot(fx, f1(fx), ls='dashed', lw=3, color = 'g')
for n in range(10):
    plt.text(Seoul_srt['Population'][n]*1.02, Seoul_srt['CCTV'][n]*0.98, Seoul_srt.index[n], fontsize = 15)
#plt.text(Seoul_srt['Population'][0]*1.01, Seoul_srt['CCTV'][0]*0.99, Seoul_srt.index[0], fontsize = 16)
plt.xlabel('Population')
plt.ylabel('CCTV cameras')
plt.colorbar()
plt.grid()
plt.show()
```


    
![png](\img\posts\secondpost\output_50_0.png)
    

